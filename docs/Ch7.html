<!DOCTYPE html><html>
<head>
<title>7 Numerical testing‣ Adaptively Refined Large-Eddy Simulations of Galaxy Clusters</title>
<!--Generated on Fri Feb 16 23:21:58 2018 by LaTeXML (version 0.8.2) http://dlmf.nist.gov/LaTeXML/.-->
<!--Document created on February 16, 2018.-->

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link rel="stylesheet" href="LaTeXML.css" type="text/css">
<link rel="stylesheet" href="ltx-book.css" type="text/css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=MML_CHTML" type="text/javascript"></script>
<link rel="up" href="." title="Adaptively Refined Large-Eddy Simulations of Galaxy Clusters">
<link rel="start" href="." title="Adaptively Refined Large-Eddy Simulations of Galaxy Clusters">
<link rel="prev" href="Ch6.html" title="Chapter 6 AMR and LES ‣ Adaptively Refined Large-Eddy Simulations of Galaxy Clusters">
<link rel="next" href="Ch8.html" title="Chapter 8 Cluster physics ‣ Adaptively Refined Large-Eddy Simulations of Galaxy Clusters">
<link rel="chapter" href="Ch1.html" title="Chapter 1 Introduction ‣ Adaptively Refined Large-Eddy Simulations of Galaxy Clusters">
<link rel="chapter" href="Ch2.html" title="Chapter 2 Turbulence ‣ Adaptively Refined Large-Eddy Simulations of Galaxy Clusters">
<link rel="chapter" href="Ch3.html" title="Chapter 3 Filter formalism ‣ Adaptively Refined Large-Eddy Simulations of Galaxy Clusters">
<link rel="chapter" href="Ch4.html" title="Chapter 4 Favre-filtered equations of fluid dynamics ‣ Adaptively Refined Large-Eddy Simulations of Galaxy Clusters">
<link rel="chapter" href="Ch5.html" title="Chapter 5 LES and SGS model ‣ Adaptively Refined Large-Eddy Simulations of Galaxy Clusters">
<link rel="chapter" href="Ch6.html" title="Chapter 6 AMR and LES ‣ Adaptively Refined Large-Eddy Simulations of Galaxy Clusters">
<link rel="chapter" href="Ch8.html" title="Chapter 8 Cluster physics ‣ Adaptively Refined Large-Eddy Simulations of Galaxy Clusters">
<link rel="chapter" href="Ch9.html" title="Chapter 9 Simulations of galaxy clusters ‣ Adaptively Refined Large-Eddy Simulations of Galaxy Clusters">
<link rel="chapter" href="Ch10.html" title="Chapter 10 Summary and Conclusions ‣ Adaptively Refined Large-Eddy Simulations of Galaxy Clusters">
<link rel="appendix" href="A1.html" title="Appendix A Dimensional analysis ‣ Adaptively Refined Large-Eddy Simulations of Galaxy Clusters">
<link rel="appendix" href="A2.html" title="Appendix B Properties of second order tensors ‣ Adaptively Refined Large-Eddy Simulations of Galaxy Clusters">
<link rel="appendix" href="A3.html" title="Appendix C Derivation of the stress tensor for a newtonian fluid ‣ Adaptively Refined Large-Eddy Simulations of Galaxy Clusters">
<link rel="appendix" href="A4.html" title="Appendix D Fourier transform and structure functions ‣ Adaptively Refined Large-Eddy Simulations of Galaxy Clusters">
<link rel="appendix" href="A5.html" title="Appendix E The divergence equation ‣ Adaptively Refined Large-Eddy Simulations of Galaxy Clusters">
<link rel="appendix" href="A6.html" title="Appendix F Vlasov-Poisson Equations ‣ Adaptively Refined Large-Eddy Simulations of Galaxy Clusters">
<link rel="appendix" href="A7.html" title="Appendix G Hydrostatic equilibrium ‣ Adaptively Refined Large-Eddy Simulations of Galaxy Clusters">
<link rel="appendix" href="A8.html" title="Appendix H Fluid dynamics in comoving coordinates ‣ Adaptively Refined Large-Eddy Simulations of Galaxy Clusters">
<link rel="appendix" href="A9.html" title="Appendix I Color fields ‣ Adaptively Refined Large-Eddy Simulations of Galaxy Clusters">
<link rel="bibliography" href="bib.html" title="References ‣ Adaptively Refined Large-Eddy Simulations of Galaxy Clusters">
<link rel="appendix" href="Ax1.html" title="Acknowledgment ‣ Adaptively Refined Large-Eddy Simulations of Galaxy Clusters">
<link rel="appendix" href="Ax2.html" title="Zusammenfassung ‣ Adaptively Refined Large-Eddy Simulations of Galaxy Clusters">
</head>
<body>
<div class="ltx_page_main">
<header class="ltx_page_header">
<div>
<a href="." title="Adaptively Refined Large-Eddy Simulations of Galaxy Clusters" class="ltx_ref" rel="up"><span class="ltx_text ltx_ref_title">Adaptively Refined Large-Eddy Simulations of Galaxy Clusters</span></a><a href="Ch6.html" title="Chapter 6 AMR and LES ‣ Adaptively Refined Large-Eddy Simulations of Galaxy Clusters" class="ltx_ref" rel="prev"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>AMR and LES</span></a><a href="Ch8.html" title="Chapter 8 Cluster physics ‣ Adaptively Refined Large-Eddy Simulations of Galaxy Clusters" class="ltx_ref" rel="next"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">8 </span>Cluster physics</span></a>
</div></header>
<div class="ltx_page_content">
<section class="ltx_chapter ltx_authors_1line">
<h1 class="ltx_title ltx_title_chapter">
<span class="ltx_tag ltx_tag_chapter">Chapter 7 </span>Numerical testing</h1>
<div class="ltx_date ltx_role_creation"></div>

<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7.1 </span>The Enzo code</h2>

<div id="S1.p1" class="ltx_para">
<p class="ltx_p">Enzo is a multiphysics, parallel AMR application for simulating the
cosmological evolution and star formation written in a mixture of C++ and
Fortran, making use of the message-passing interface (MPI) libaries and the
HDF5 data format. <cite class="ltx_cite ltx_citemacro_citet">Norman<span class="ltx_text ltx_bib_etal"> et al.</span> (<a href="bib.html#bib98" title="Simulating Cosmological Evolution with Enzo" class="ltx_ref">2007</a>)</cite> describes the newest version of the code in
detail. In the following we summarize the most important features of the code.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p class="ltx_p">Enzo simulates the evolution of dark and baryonic matter in a self-consistent
way on cosmological scales. Baryonic matter is evolved using a finite volume
discretization of the compressible fluid dynamic equations in comoving
coordinates<span class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">34</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">34</sup>See appendix <a href="A8.html#S3" title="H.3 Equations in comoving coordinates ‣ Appendix H Fluid dynamics in comoving coordinates ‣ Adaptively Refined Large-Eddy Simulations of Galaxy Clusters" class="ltx_ref"><span class="ltx_text ltx_ref_tag">H.3</span></a>.</span></span></span>. The Piecewise Parabolic
Method (PPM) in dual energy formalism for high Mach number flows is used to
integrate these equations <cite class="ltx_cite ltx_citemacro_citep">(Bryan<span class="ltx_text ltx_bib_etal"> et al.</span>, <a href="bib.html#bib22" title="A piecewise parabolic method for cosmological hydrodynamics" class="ltx_ref">1995</a>)</cite>. Energy source and
sink terms due to
radiative heating and cooling processes are included, but not used in our work.
Also we do not use the multi-species (H, H+, He, He+, He++ and e-) capabilities
of Enzo; instead we always set the gas to be fully ionized with a mean
molecular
weight <math id="S1.p2.m1" class="ltx_Math" alttext="m_{\mu}=0.6\,\mathrm{u}" display="inline"><mrow><msub><mi class="ltx_unit">m</mi><mi class="ltx_unit">μ</mi></msub><mo>=</mo><mrow><mpadded width="+1.7pt"><mn>0.6</mn></mpadded><mo>⁢</mo><mi class="ltx_unit" mathvariant="normal">u</mi></mrow></mrow></math>. Dark matter is assumed to behave as
collisionless fluid, obeying the Vlasov-Poisson system of
equations<span class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">35</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">35</sup>See appendix <a href="A6.html" title="Appendix F Vlasov-Poisson Equations ‣ Adaptively Refined Large-Eddy Simulations of Galaxy Clusters" class="ltx_ref"><span class="ltx_text ltx_ref_tag">F</span></a>.</span></span></span>. Its evolution is
solved using particle-mesh algorithms for collisionless N-body dynamics;
specifically a second order accurate Cloud-in-Cell (CIC) formulation with
leapfrog time integration is used. Dark matter and baryonic matter interact
through their
gravitational potential. The gravitational potential is computed by solving the
Poisson equation on the adaptive grid hierarchy using Fast Fourier Transform and
multigrid techniques. In generic terms, Enzo is a fluid solver for the baryonic
matter coupled to a particle-mesh solver for the dark matter via a Poisson
solver. The coordinates of the simulation domain are given as comoving
coordinates in an expanding universe with a scale factor <math id="S1.p2.m2" class="ltx_Math" alttext="a(t)" display="inline"><mrow><mi>a</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></mrow></math>, which is
computed as a solution of the Friedman equation.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p class="ltx_p">The code uses blockstructured adaptive mesh refinement (as described in
section <a href="Ch6.html#S1" title="6.1 Adaptive mesh refinement ‣ Chapter 6 AMR and LES ‣ Adaptively Refined Large-Eddy Simulations of Galaxy Clusters" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6.1</span></a>) to achieve high resolution. To parallelize the computation,
a concept of ghost grids is used. The root grid is split into a number of grid
patches, at least as many as the number of processors. Then, as grids
are added, each grid is placed by default on the same processor as its parent.
Once the rebuild of the hierarchy has been completed on a given level, the load
balancing ratio between processors is computed and grids are transfered between
processors in an attempt to even the load. However, the structure of the
grid patch hierarchy is stored redundantly on every processor to ease
communication. To allow for this, each real grid, which resides on only one
processor, is represented by a ghost grid (which is a grid patch without data)
on every other processor. This structure is shown graphically in figure
<a href="#F1" title="Figure 7.1 ‣ 7.1 The Enzo code ‣ Chapter 7 Numerical testing ‣ Adaptively Refined Large-Eddy Simulations of Galaxy Clusters" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.1</span></a>.</p>
</div>
<figure id="F1" class="ltx_figure"><img src="x10.png" id="F1.g1" class="ltx_graphics ltx_centering" width="474" height="219" alt="">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7.1: </span>Real and ghost grids in a hierarchy; real and ghost zones in a grid
<cite class="ltx_cite ltx_citemacro_citep">(Norman<span class="ltx_text ltx_bib_etal"> et al.</span>, <a href="bib.html#bib98" title="Simulating Cosmological Evolution with Enzo" class="ltx_ref">2007</a>)</cite>.</figcaption>
</figure>
<div id="S1.p4" class="ltx_para">
<p class="ltx_p">Enzo is publicly available from <a href="http://lca.ucsd.edu/software/enzo/" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://lca.ucsd.edu/software/enzo/</a>.
However to integrate and test our SGS model several modifications to the public
version were necessary.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7.2 </span>Modifications to Enzo</h2>

<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">7.2.1 </span>Turbulent energy as a color field</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p class="ltx_p">To implement the Schmidt model into Enzo, it was necessary to introduce a new
field for the turbulent energy, which is advected by the PPM solver. To achieve
this, we used the capability of Enzo to incorporate an arbitrary number of
color fields<span class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">36</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">36</sup>See appendix <a href="A9.html" title="Appendix I Color fields ‣ Adaptively Refined Large-Eddy Simulations of Galaxy Clusters" class="ltx_ref"><span class="ltx_text ltx_ref_tag">I</span></a>.</span></span></span> into the simulation. Thus the
turbulent energy field is implemented as another color field. Nevertheless it
was necessary to change the default behavior of color fields in Enzo. By
default, Enzo treats a color like a density. But since we want turbulent energy
to be treated in analogy to the internal energy, which is implemented as
specific quantity, we changed the treatment of color fields in our version of
Enzo as to behave like a specific quantity.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">7.2.2 </span>Coupling of turbulent energy and time step restriction</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p class="ltx_p">The source/sink terms in the turbulent energy equation and the terms arising in
the internal energy equation and the momentum equation due to our subgrid model
are coupled to the fields in first order, which means for some arbitrary field
<math id="S2.SS2.p1.m1" class="ltx_Math" alttext="f" display="inline"><mi>f</mi></math> at timestep <math id="S2.SS2.p1.m2" class="ltx_Math" alttext="t_{n}" display="inline"><msub><mi>t</mi><mi>n</mi></msub></math>, the source terms <math id="S2.SS2.p1.m3" class="ltx_Math" alttext="s_{1},s_{2},\ldots" display="inline"><mrow><msub><mi>s</mi><mn>1</mn></msub><mo>,</mo><msub><mi>s</mi><mn>2</mn></msub><mo>,</mo><mi mathvariant="normal">…</mi></mrow></math> are added in the
following way</p>
<table id="Ax2.S3.EGx93" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="E1.m1" class="ltx_Math" alttext="\displaystyle f_{n+1}=f_{n}+s_{1,n}\Delta t+s_{2,n}\Delta t+\ldots" display="inline"><mrow><msub><mi>f</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><mrow><msub><mi>f</mi><mi>n</mi></msub><mo>+</mo><mrow><msub><mi>s</mi><mrow><mn>1</mn><mo>,</mo><mi>n</mi></mrow></msub><mo>⁢</mo><mi mathvariant="normal">Δ</mi><mo>⁢</mo><mi>t</mi></mrow><mo>+</mo><mrow><msub><mi>s</mi><mrow><mn>2</mn><mo>,</mo><mi>n</mi></mrow></msub><mo>⁢</mo><mi mathvariant="normal">Δ</mi><mo>⁢</mo><mi>t</mi></mrow><mo>+</mo><mi mathvariant="normal">…</mi></mrow></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7.1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">where <math id="S2.SS2.p1.m4" class="ltx_Math" alttext="\Delta t=t_{n+1}-t_{n}" display="inline"><mrow><mrow><mi mathvariant="normal">Δ</mi><mo>⁢</mo><mi>t</mi></mrow><mo>=</mo><mrow><msub><mi>t</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>-</mo><msub><mi>t</mi><mi>n</mi></msub></mrow></mrow></math> is the chosen timestep. But due to the low
accuracy of the scheme, it might happen, that for a big timestep the value of
one of the energy fields in a cell drops below zero, which is unphysical and
numerically unstable. To account for that, we had to restrict the timestep in
the code. We do this by applying the following estimator</p>
<table id="Ax2.S3.EGx94" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="E2.m1" class="ltx_Math" alttext="\displaystyle\Delta t_{turb}=C_{turb}\min{\left(\sqrt{\frac{l_{\Delta}}{\left%
\lvert\boldsymbol{a}_{turb}\right\rvert}}\right)}," display="inline"><mrow><mrow><mrow><mi mathvariant="normal">Δ</mi><mo>⁢</mo><msub><mi>t</mi><mrow><mi>t</mi><mo>⁢</mo><mi>u</mi><mo>⁢</mo><mi>r</mi><mo>⁢</mo><mi>b</mi></mrow></msub></mrow><mo>=</mo><mrow><msub><mi>C</mi><mrow><mi>t</mi><mo>⁢</mo><mi>u</mi><mo>⁢</mo><mi>r</mi><mo>⁢</mo><mi>b</mi></mrow></msub><mo>⁢</mo><mrow><mi>min</mi><mo>⁡</mo><mrow><mo>(</mo><msqrt><mstyle displaystyle="true"><mfrac><msub><mi>l</mi><mi mathvariant="normal">Δ</mi></msub><mrow><mo fence="true">|</mo><msub><mi>𝒂</mi><mrow><mi>t</mi><mo>⁢</mo><mi>u</mi><mo>⁢</mo><mi>r</mi><mo>⁢</mo><mi>b</mi></mrow></msub><mo fence="true">|</mo></mrow></mfrac></mstyle></msqrt><mo>)</mo></mrow></mrow></mrow></mrow><mo>,</mo></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7.2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">where the minimum is taken over all cells of all grids on one
level of refinement, the turbulent acceleration is <math id="S2.SS2.p1.m5" class="ltx_Math" alttext="\boldsymbol{a}_{turb}=\frac{1}{\langle\rho\rangle}{\frac{\partial}{\partial r_%
{j}}\hat{\tau}(v_{i},v_{j})}" display="inline"><mrow><msub><mi>𝒂</mi><mrow><mi>t</mi><mo>⁢</mo><mi>u</mi><mo>⁢</mo><mi>r</mi><mo>⁢</mo><mi>b</mi></mrow></msub><mo>=</mo><mrow><mfrac><mn>1</mn><mrow><mo stretchy="false">⟨</mo><mi>ρ</mi><mo stretchy="false">⟩</mo></mrow></mfrac><mo>⁢</mo><mfrac><mo>∂</mo><mrow><mo>∂</mo><mo>⁡</mo><msub><mi>r</mi><mi>j</mi></msub></mrow></mfrac><mo>⁢</mo><mover accent="true"><mi>τ</mi><mo stretchy="false">^</mo></mover><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub><mi>v</mi><mi>i</mi></msub><mo>,</mo><msub><mi>v</mi><mi>j</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mrow></math> and <math id="S2.SS2.p1.m6" class="ltx_Math" alttext="C_{turb}=0.05" display="inline"><mrow><msub><mi>C</mi><mrow><mi>t</mi><mo>⁢</mo><mi>u</mi><mo>⁢</mo><mi>r</mi><mo>⁢</mo><mi>b</mi></mrow></msub><mo>=</mo><mn>0.05</mn></mrow></math>. If
the so-estimated minimal allowed timestep due to our turbulent model <math id="S2.SS2.p1.m7" class="ltx_Math" alttext="\Delta t_{turb}" display="inline"><mrow><mi mathvariant="normal">Δ</mi><mo>⁢</mo><msub><mi>t</mi><mrow><mi>t</mi><mo>⁢</mo><mi>u</mi><mo>⁢</mo><mi>r</mi><mo>⁢</mo><mi>b</mi></mrow></msub></mrow></math> is smaller than the timestep computed by the other estimators
in the code (e.g. estimator based on the CFL-criterion, for gravity and so on)
it will be chosen as the timestep for the next iteration. This procedure
ensures that even for big turbulent acceleration (which also means
big source/sink terms) due to our turbulent model, our computation is
numerically stable. Of course, there is one drawback to this procedure: if the
turbulent acceleration becomes really huge, the timestep of the simulation will
be extremely small, effectively stopping the simulation. This can only be
circumvented by either using a higher accuracy scheme for coupling the
sink/source terms to the equations or by using a different subgrid model, which
does not produce numerically instable huge values of <math id="S2.SS2.p1.m8" class="ltx_Math" alttext="\left\lvert\boldsymbol{a}_{turb}\right\rvert" display="inline"><mrow><mo fence="true">|</mo><msub><mi>𝒂</mi><mrow><mi>t</mi><mo>⁢</mo><mi>u</mi><mo>⁢</mo><mi>r</mi><mo>⁢</mo><mi>b</mi></mrow></msub><mo fence="true">|</mo></mrow></math>.
The Sarkar corrections are a step in this direction, but further steps may be
necessary in the future.</p>
</div>
</section>
<section id="S2.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">7.2.3 </span>Transfer of turbulent energy at grid refinement/derefinement</h3>

<div id="S2.SS3.p1" class="ltx_para">
<p class="ltx_p">By default, when a new finer grid gets created in Enzo, the values on the finer
grid are generated by interpolating them from the coarser grid using a
conservative interpolation scheme. At each timestep of the coarse grid, the
values from the fine grid are averaged and replace the values computed on the
coarse grid in the region where fine and coarse grid overlap. As already
mentioned in section <a href="Ch6.html#S3" title="6.3 ϵ -based approach to combine AMR and LES ‣ Chapter 6 AMR and LES ‣ Adaptively Refined Large-Eddy Simulations of Galaxy Clusters" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6.3</span></a> these procedures must be modified in our
approach to combine LES and AMR.</p>
</div>
<div id="S2.SS3.p2" class="ltx_para">
<p class="ltx_p">So at refinement we do the following:</p>
<ol id="I1" class="ltx_enumerate">
<li id="I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_enumerate">1.</span> 
<div id="I1.i1.p1" class="ltx_para">
<p class="ltx_p">Interpolate the values from the coarse to the fine grid using standard
interpolation scheme from Enzo.</p>
</div>
</li>
<li id="I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_enumerate">2.</span> 
<div id="I1.i2.p1" class="ltx_para">
<p class="ltx_p">On the finer grid, correct the values of specific kinetic energy
<math id="I1.i2.p1.m1" class="ltx_Math" alttext="e_{k}=\frac{1}{2}v^{2}" display="inline"><mrow><msub><mi>e</mi><mi>k</mi></msub><mo>=</mo><mrow><mfrac><mn>1</mn><mn>2</mn></mfrac><mo>⁢</mo><msup><mi>v</mi><mn>2</mn></msup></mrow></mrow></math>, velocity components <math id="I1.i2.p1.m2" class="ltx_Math" alttext="v_{i}" display="inline"><msub><mi>v</mi><mi>i</mi></msub></math> and specific turbulent energy
<math id="I1.i2.p1.m3" class="ltx_Math" alttext="e_{t}=\frac{1}{2}q^{2}" display="inline"><mrow><msub><mi>e</mi><mi>t</mi></msub><mo>=</mo><mrow><mfrac><mn>1</mn><mn>2</mn></mfrac><mo>⁢</mo><msup><mi>q</mi><mn>2</mn></msup></mrow></mrow></math> as follows</p>
<table id="Ax2.S3.EGx95" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="E3.m1" class="ltx_Math" alttext="\displaystyle e^{\prime}_{k}" display="inline"><msubsup><mi>e</mi><mi>k</mi><mo>′</mo></msubsup></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="E3.m2" class="ltx_Math" alttext="\displaystyle=e_{k}+e_{t}{\left(1-r^{-2/3}\right)}," display="inline"><mrow><mrow><mi></mi><mo>=</mo><mrow><msub><mi>e</mi><mi>k</mi></msub><mo>+</mo><mrow><msub><mi>e</mi><mi>t</mi></msub><mo>⁢</mo><mrow><mo>(</mo><mrow><mn>1</mn><mo>-</mo><msup><mi>r</mi><mrow><mo>-</mo><mrow><mn>2</mn><mo>/</mo><mn>3</mn></mrow></mrow></msup></mrow><mo>)</mo></mrow></mrow></mrow></mrow><mo>,</mo></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7.3)</span></td>
</tr></tbody>
<tbody id="E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="E4.m1" class="ltx_Math" alttext="\displaystyle v^{\prime}_{i}" display="inline"><msubsup><mi>v</mi><mi>i</mi><mo>′</mo></msubsup></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="E4.m2" class="ltx_Math" alttext="\displaystyle=v_{i}\sqrt{1+\frac{e_{t}}{e_{k}}{\left(1-r^{-2/3}\right)}}," display="inline"><mrow><mrow><mi></mi><mo>=</mo><mrow><msub><mi>v</mi><mi>i</mi></msub><mo>⁢</mo><msqrt><mrow><mn>1</mn><mo>+</mo><mrow><mstyle displaystyle="true"><mfrac><msub><mi>e</mi><mi>t</mi></msub><msub><mi>e</mi><mi>k</mi></msub></mfrac></mstyle><mo>⁢</mo><mrow><mo>(</mo><mrow><mn>1</mn><mo>-</mo><msup><mi>r</mi><mrow><mo>-</mo><mrow><mn>2</mn><mo>/</mo><mn>3</mn></mrow></mrow></msup></mrow><mo>)</mo></mrow></mrow></mrow></msqrt></mrow></mrow><mo>,</mo></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7.4)</span></td>
</tr></tbody>
<tbody id="E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="E5.m1" class="ltx_Math" alttext="\displaystyle e^{\prime}_{t}" display="inline"><msubsup><mi>e</mi><mi>t</mi><mo>′</mo></msubsup></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="E5.m2" class="ltx_Math" alttext="\displaystyle=e_{t}-e_{t}{\left(1-r^{-2/3}\right)}," display="inline"><mrow><mrow><mi></mi><mo>=</mo><mrow><msub><mi>e</mi><mi>t</mi></msub><mo>-</mo><mrow><msub><mi>e</mi><mi>t</mi></msub><mo>⁢</mo><mrow><mo>(</mo><mrow><mn>1</mn><mo>-</mo><msup><mi>r</mi><mrow><mo>-</mo><mrow><mn>2</mn><mo>/</mo><mn>3</mn></mrow></mrow></msup></mrow><mo>)</mo></mrow></mrow></mrow></mrow><mo>,</mo></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7.5)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">where primed quantities are the final values on the fine grid.</p>
</div>
</li>
</ol>
</div>
<div id="S2.SS3.p3" class="ltx_para">
<p class="ltx_p">At derefinement we reverse this procedure:</p>
<ol id="I2" class="ltx_enumerate">
<li id="I2.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_enumerate">1.</span> 
<div id="I2.i1.p1" class="ltx_para">
<p class="ltx_p">Average the values from the fine grid and replace the corresponding values
on the coarse grid</p>
</div>
</li>
<li id="I2.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_enumerate">2.</span> 
<div id="I2.i2.p1" class="ltx_para">
<p class="ltx_p">On the coarse grid, correct the averaged values of kinetic energy,
velocity components and turbulent energy</p>
<table id="Ax2.S3.EGx96" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="E6.m1" class="ltx_Math" alttext="\displaystyle e^{\prime}_{t}" display="inline"><msubsup><mi>e</mi><mi>t</mi><mo>′</mo></msubsup></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="E6.m2" class="ltx_Math" alttext="\displaystyle=e_{t}+e_{t}{\left(r^{2/3}-1\right)}," display="inline"><mrow><mrow><mi></mi><mo>=</mo><mrow><msub><mi>e</mi><mi>t</mi></msub><mo>+</mo><mrow><msub><mi>e</mi><mi>t</mi></msub><mo>⁢</mo><mrow><mo>(</mo><mrow><msup><mi>r</mi><mrow><mn>2</mn><mo>/</mo><mn>3</mn></mrow></msup><mo>-</mo><mn>1</mn></mrow><mo>)</mo></mrow></mrow></mrow></mrow><mo>,</mo></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7.6)</span></td>
</tr></tbody>
<tbody id="E7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="E7.m1" class="ltx_Math" alttext="\displaystyle v^{\prime}_{i}" display="inline"><msubsup><mi>v</mi><mi>i</mi><mo>′</mo></msubsup></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="E7.m2" class="ltx_Math" alttext="\displaystyle=v_{i}\sqrt{1-\frac{e_{t}}{e_{k}}{\left(r^{2/3}-1\right)}}," display="inline"><mrow><mrow><mi></mi><mo>=</mo><mrow><msub><mi>v</mi><mi>i</mi></msub><mo>⁢</mo><msqrt><mrow><mn>1</mn><mo>-</mo><mrow><mstyle displaystyle="true"><mfrac><msub><mi>e</mi><mi>t</mi></msub><msub><mi>e</mi><mi>k</mi></msub></mfrac></mstyle><mo>⁢</mo><mrow><mo>(</mo><mrow><msup><mi>r</mi><mrow><mn>2</mn><mo>/</mo><mn>3</mn></mrow></msup><mo>-</mo><mn>1</mn></mrow><mo>)</mo></mrow></mrow></mrow></msqrt></mrow></mrow><mo>,</mo></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7.7)</span></td>
</tr></tbody>
<tbody id="E8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="E8.m1" class="ltx_Math" alttext="\displaystyle e^{\prime}_{k}" display="inline"><msubsup><mi>e</mi><mi>k</mi><mo>′</mo></msubsup></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="E8.m2" class="ltx_Math" alttext="\displaystyle=e_{k}-e_{t}{\left(r^{2/3}-1\right)}." display="inline"><mrow><mrow><mi></mi><mo>=</mo><mrow><msub><mi>e</mi><mi>k</mi></msub><mo>-</mo><mrow><msub><mi>e</mi><mi>t</mi></msub><mo>⁢</mo><mrow><mo>(</mo><mrow><msup><mi>r</mi><mrow><mn>2</mn><mo>/</mo><mn>3</mn></mrow></msup><mo>-</mo><mn>1</mn></mrow><mo>)</mo></mrow></mrow></mrow></mrow><mo>.</mo></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7.8)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">Here primed quantities denote the final values on the coarse grid.</p>
</div>
</li>
</ol>
<p class="ltx_p">It should be noted that derefinement with this procedure is only possible if
there is enough kinetic energy on the fine grid, because on the coarse grid, we
must have <math id="S2.SS3.p3.m1" class="ltx_Math" alttext="e^{\prime}_{k}\geq 0" display="inline"><mrow><msubsup><mi>e</mi><mi>k</mi><mo>′</mo></msubsup><mo>≥</mo><mn>0</mn></mrow></math>. This is only the case for
</p>
<table id="Ax2.S3.EGx97" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="E9"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="E9.m1" class="ltx_Math" alttext="\displaystyle\frac{e_{t}}{e_{k}}\leq{\left(r^{2/3}-1\right)}." display="inline"><mrow><mrow><mstyle displaystyle="true"><mfrac><msub><mi>e</mi><mi>t</mi></msub><msub><mi>e</mi><mi>k</mi></msub></mfrac></mstyle><mo>≤</mo><mrow><mo>(</mo><mrow><msup><mi>r</mi><mrow><mn>2</mn><mo>/</mo><mn>3</mn></mrow></msup><mo>-</mo><mn>1</mn></mrow><mo>)</mo></mrow></mrow><mo>.</mo></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7.9)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">For example for a refinement ratio <math id="S2.SS3.p3.m2" class="ltx_Math" alttext="r=2" display="inline"><mrow><mi>r</mi><mo>=</mo><mn>2</mn></mrow></math> this yields <math id="S2.SS3.p3.m3" class="ltx_Math" alttext="e_{k}\geq 0.58e_{t}" display="inline"><mrow><msub><mi>e</mi><mi>k</mi></msub><mo>≥</mo><mrow><mn>0.58</mn><mo>⁢</mo><msub><mi>e</mi><mi>t</mi></msub></mrow></mrow></math>.
So if this criterion is not satisfied, we do not correct the values of the
energies and velocities at derefinement.<span class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">37</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">37</sup>One might ask, why not do
the correction step before the interpolation/averaging step, since that might
produce less noise. The reason for our choice was, that otherwise we would had
to introduce an additional temporary field into the code, which would lower
the performance.</span></span></span></p>
</div>
</section>
<section id="S2.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">7.2.4 </span>Random forcing</h3>

<div id="S2.SS4.p1" class="ltx_para">
<p class="ltx_p">To simulate driven turbulent flow, a random forcing mechanism was implemented
into our version of Enzo. The forcing field is generated by a stochastic
differential equation called Ornstein-Uhlenbeck process
<cite class="ltx_cite ltx_citemacro_citep">(Schmidt, <a href="bib.html#bib136" title="Turbulent Thermonuclear Combustion in Degenerate Stars" class="ltx_ref">2004</a>)</cite>. This
process generates a temporally and spatially varying force field which acts on
the fluid. The components of the force are generated in Fourier space, because
there it is easier to split the force field into a solenoidal and a
dilatational (compressive) part.<span class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">38</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">38</sup>Also called Helmholtz decomposition,
see <cite class="ltx_cite ltx_citemacro_citet">Schmidt (<a href="bib.html#bib136" title="Turbulent Thermonuclear Combustion in Degenerate Stars" class="ltx_ref">2004</a>)</cite>.</span></span></span> Hence the force field is characterized by a weight
<math id="S2.SS4.p1.m1" class="ltx_Math" alttext="\zeta" display="inline"><mi>ζ</mi></math>, which is zero, if the force field is purely compressive (which means it
will not directly generate any vorticity), and one, if the force field
is purely solenoidal (which means it will not directly generate any
divergence in the velocity field). The strength of the force field is
characterized by a forcing
Mach number <math id="S2.SS4.p1.m2" class="ltx_Math" alttext="M_{f}" display="inline"><msub><mi>M</mi><mi>f</mi></msub></math>, which is loosely connected to the mean Mach number reached
in the simulation after one integral time</p>
<table id="Ax2.S3.EGx98" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="E10"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="E10.m1" class="ltx_Math" alttext="\displaystyle t_{int}=\frac{l_{0}}{M_{f}\langle c_{s}\rangle}," display="inline"><mrow><mrow><msub><mi>t</mi><mrow><mi>i</mi><mo>⁢</mo><mi>n</mi><mo>⁢</mo><mi>t</mi></mrow></msub><mo>=</mo><mstyle displaystyle="true"><mfrac><msub><mi>l</mi><mn>0</mn></msub><mrow><msub><mi>M</mi><mi>f</mi></msub><mo>⁢</mo><mrow><mo stretchy="false">⟨</mo><msub><mi>c</mi><mi>s</mi></msub><mo stretchy="false">⟩</mo></mrow></mrow></mfrac></mstyle></mrow><mo>,</mo></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7.10)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">where <math id="S2.SS4.p1.m3" class="ltx_Math" alttext="l_{0}" display="inline"><msub><mi>l</mi><mn>0</mn></msub></math> is the mean driving length scale size and
<math id="S2.SS4.p1.m4" class="ltx_Math" alttext="\langle c_{s}\rangle" display="inline"><mrow><mo stretchy="false">⟨</mo><msub><mi>c</mi><mi>s</mi></msub><mo stretchy="false">⟩</mo></mrow></math> is the mean sound speed. The force field is adjusted to drive
the fluid only on length scales around the characteristic forcing length <math id="S2.SS4.p1.m5" class="ltx_Math" alttext="l_{0}=\frac{l_{box}}{\alpha_{f}}" display="inline"><mrow><msub><mi>l</mi><mn>0</mn></msub><mo>=</mo><mfrac><msub><mi>l</mi><mrow><mi>b</mi><mo>⁢</mo><mi>o</mi><mo>⁢</mo><mi>x</mi></mrow></msub><msub><mi>α</mi><mi>f</mi></msub></mfrac></mrow></math> with <math id="S2.SS4.p1.m6" class="ltx_Math" alttext="\alpha_{f}=2" display="inline"><mrow><msub><mi>α</mi><mi>f</mi></msub><mo>=</mo><mn>2</mn></mrow></math> to allow for an
undisturbed generation of the energy dissipation cascade down to smaller
scales.</p>
</div>
</section>
<section id="S2.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">7.2.5 </span>Statistics tool</h3>

<div id="S2.SS5.p1" class="ltx_para">
<p class="ltx_p">To be able to extract and analyze statistical quantities from the simulation,
sophisticated routines have been implemented, which allow us to compute
mass weighted and normal mean values, standard deviations and root mean square
values at every cycle for each quantity and for each level of an AMR simulation.
We make heavy use of these routines in the following sections.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7.3 </span>Energy conservation</h2>

<div id="S3.p1" class="ltx_para">
<p class="ltx_p">Global conservation of energy in a fluid code with a SGS model like the
Schmidt model is not achieved easily. This is because of the nonlocal features
of this model. As shown in chapter <a href="Ch4.html" title="Chapter 4 Favre-filtered equations of fluid dynamics ‣ Adaptively Refined Large-Eddy Simulations of Galaxy Clusters" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, the equation of turbulent energy
(<a href="Ch4.html#E29" title="(4.29) ‣ 4.3 Summary ‣ Chapter 4 Favre-filtered equations of fluid dynamics ‣ Adaptively Refined Large-Eddy Simulations of Galaxy Clusters" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.29</span></a>) is generated by subtracting the equation of resolved kinetic
energy (<a href="Ch4.html#E30" title="(4.30) ‣ 4.3 Summary ‣ Chapter 4 Favre-filtered equations of fluid dynamics ‣ Adaptively Refined Large-Eddy Simulations of Galaxy Clusters" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.30</span></a>) from the filtered equation of turbulent energy
<a href="Ch4.html#E6" title="(4.6) ‣ 4.1 Basic equations ‣ Chapter 4 Favre-filtered equations of fluid dynamics ‣ Adaptively Refined Large-Eddy Simulations of Galaxy Clusters" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.6</span></a>. In other words, the sum of turbulent energy equation and
resolved energy equation must yield the filtered kinetic energy equation.
In particular, the sum of turbulent production term
<math id="S3.p1.m1" class="ltx_Math" alttext="\hat{\tau}(v_{j},v_{i})\frac{\partial}{\partial r_{j}}\hat{v_{i}}" display="inline"><mrow><mover accent="true"><mi>τ</mi><mo stretchy="false">^</mo></mover><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub><mi>v</mi><mi>j</mi></msub><mo>,</mo><msub><mi>v</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><mo>⁢</mo><mfrac><mo>∂</mo><mrow><mo>∂</mo><mo>⁡</mo><msub><mi>r</mi><mi>j</mi></msub></mrow></mfrac><mo>⁢</mo><mover accent="true"><msub><mi>v</mi><mi>i</mi></msub><mo stretchy="false">^</mo></mover></mrow></math> and resolved kinetic energy reduction
term <math id="S3.p1.m2" class="ltx_Math" alttext="\hat{v}_{i}\frac{\partial}{\partial r_{j}}\hat{\tau}(v_{i},v_{j})" display="inline"><mrow><msub><mover accent="true"><mi>v</mi><mo stretchy="false">^</mo></mover><mi>i</mi></msub><mo>⁢</mo><mfrac><mo>∂</mo><mrow><mo>∂</mo><mo>⁡</mo><msub><mi>r</mi><mi>j</mi></msub></mrow></mfrac><mo>⁢</mo><mover accent="true"><mi>τ</mi><mo stretchy="false">^</mo></mover><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub><mi>v</mi><mi>i</mi></msub><mo>,</mo><msub><mi>v</mi><mi>j</mi></msub><mo stretchy="false">)</mo></mrow></mrow></math> must add
up to the corresponding flux term in the filtered equation of kinetic energy</p>
<table id="Ax2.S3.EGx99" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="E11"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="E11.m1" class="ltx_Math" alttext="\displaystyle\frac{\partial}{\partial r_{j}}\hat{v}_{i}\hat{\tau}(v_{i},v_{j})%
=\hat{v}_{i}\frac{\partial}{\partial r_{j}}\hat{\tau}(v_{i},v_{j})+\hat{\tau}(%
v_{j},v_{i})\frac{\partial}{\partial r_{j}}\hat{v_{i}}." display="inline"><mrow><mrow><mrow><mstyle displaystyle="true"><mfrac><mo>∂</mo><mrow><mo>∂</mo><mo>⁡</mo><msub><mi>r</mi><mi>j</mi></msub></mrow></mfrac></mstyle><mo>⁢</mo><msub><mover accent="true"><mi>v</mi><mo stretchy="false">^</mo></mover><mi>i</mi></msub><mo>⁢</mo><mover accent="true"><mi>τ</mi><mo stretchy="false">^</mo></mover><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub><mi>v</mi><mi>i</mi></msub><mo>,</mo><msub><mi>v</mi><mi>j</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><msub><mover accent="true"><mi>v</mi><mo stretchy="false">^</mo></mover><mi>i</mi></msub><mo>⁢</mo><mstyle displaystyle="true"><mfrac><mo>∂</mo><mrow><mo>∂</mo><mo>⁡</mo><msub><mi>r</mi><mi>j</mi></msub></mrow></mfrac></mstyle><mo>⁢</mo><mover accent="true"><mi>τ</mi><mo stretchy="false">^</mo></mover><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub><mi>v</mi><mi>i</mi></msub><mo>,</mo><msub><mi>v</mi><mi>j</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo>+</mo><mrow><mover accent="true"><mi>τ</mi><mo stretchy="false">^</mo></mover><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub><mi>v</mi><mi>j</mi></msub><mo>,</mo><msub><mi>v</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><mo>⁢</mo><mstyle displaystyle="true"><mfrac><mo>∂</mo><mrow><mo>∂</mo><mo>⁡</mo><msub><mi>r</mi><mi>j</mi></msub></mrow></mfrac></mstyle><mo>⁢</mo><mover accent="true"><msub><mi>v</mi><mi>i</mi></msub><mo stretchy="false">^</mo></mover></mrow></mrow></mrow><mo>.</mo></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7.11)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">This is important, since we know that the integral of the flux term over the
whole volume must be zero</p>
<table id="Ax2.S3.EGx100" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="E12"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="E12.m1" class="ltx_Math" alttext="\displaystyle\int\frac{\partial}{\partial r_{j}}\hat{v}_{i}\hat{\tau}(v_{i},v_%
{j})dV=\oint\hat{v}_{i}\hat{\tau}(v_{i},v_{j})dA=0." display="inline"><mrow><mrow><mstyle displaystyle="true"><mrow><mo largeop="true" symmetric="true">∫</mo><mrow><mfrac><mo>∂</mo><mrow><mo>∂</mo><mo>⁡</mo><msub><mi>r</mi><mi>j</mi></msub></mrow></mfrac><mo>⁢</mo><msub><mover accent="true"><mi>v</mi><mo stretchy="false">^</mo></mover><mi>i</mi></msub><mo>⁢</mo><mover accent="true"><mi>τ</mi><mo stretchy="false">^</mo></mover><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub><mi>v</mi><mi>i</mi></msub><mo>,</mo><msub><mi>v</mi><mi>j</mi></msub><mo stretchy="false">)</mo></mrow><mo>⁢</mo><mrow><mo>𝑑</mo><mi>V</mi></mrow></mrow></mrow></mstyle><mo>=</mo><mstyle displaystyle="true"><mrow><mo largeop="true" symmetric="true">∮</mo><mrow><msub><mover accent="true"><mi>v</mi><mo stretchy="false">^</mo></mover><mi>i</mi></msub><mo>⁢</mo><mover accent="true"><mi>τ</mi><mo stretchy="false">^</mo></mover><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub><mi>v</mi><mi>i</mi></msub><mo>,</mo><msub><mi>v</mi><mi>j</mi></msub><mo stretchy="false">)</mo></mrow><mo>⁢</mo><mrow><mo>𝑑</mo><mi>A</mi></mrow></mrow></mrow></mstyle><mo>=</mo><mn>0</mn></mrow><mo>.</mo></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7.12)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">But this is not guaranteed numerically, if we compute the turbulent production
term and the kinetic energy reduction term independent of each other, since
small numerical errors might lead to a violation of equation (<a href="#E11" title="(7.11) ‣ 7.3 Energy conservation ‣ Chapter 7 Numerical testing ‣ Adaptively Refined Large-Eddy Simulations of Galaxy Clusters" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.11</span></a>)
locally, which leads to a big violation of equation (<a href="#E12" title="(7.12) ‣ 7.3 Energy conservation ‣ Chapter 7 Numerical testing ‣ Adaptively Refined Large-Eddy Simulations of Galaxy Clusters" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.12</span></a>)
globally.</p>
</div>
<div id="S3.p2" class="ltx_para">
<p class="ltx_p">We therefore compute the resolved kinetic energy reduction term indirectly as
</p>
<table id="Ax2.S3.EGx101" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="E13"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="E13.m1" class="ltx_Math" alttext="\displaystyle\hat{v}_{i}\frac{\partial}{\partial r_{j}}\hat{\tau}(v_{i},v_{j})%
=\frac{\partial}{\partial r_{j}}\hat{v}_{i}\hat{\tau}(v_{i},v_{j})-\hat{\tau}(%
v_{j},v_{i})\frac{\partial}{\partial r_{j}}\hat{v_{i}}," display="inline"><mrow><mrow><mrow><msub><mover accent="true"><mi>v</mi><mo stretchy="false">^</mo></mover><mi>i</mi></msub><mo>⁢</mo><mstyle displaystyle="true"><mfrac><mo>∂</mo><mrow><mo>∂</mo><mo>⁡</mo><msub><mi>r</mi><mi>j</mi></msub></mrow></mfrac></mstyle><mo>⁢</mo><mover accent="true"><mi>τ</mi><mo stretchy="false">^</mo></mover><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub><mi>v</mi><mi>i</mi></msub><mo>,</mo><msub><mi>v</mi><mi>j</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><mstyle displaystyle="true"><mfrac><mo>∂</mo><mrow><mo>∂</mo><mo>⁡</mo><msub><mi>r</mi><mi>j</mi></msub></mrow></mfrac></mstyle><mo>⁢</mo><msub><mover accent="true"><mi>v</mi><mo stretchy="false">^</mo></mover><mi>i</mi></msub><mo>⁢</mo><mover accent="true"><mi>τ</mi><mo stretchy="false">^</mo></mover><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub><mi>v</mi><mi>i</mi></msub><mo>,</mo><msub><mi>v</mi><mi>j</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo>-</mo><mrow><mover accent="true"><mi>τ</mi><mo stretchy="false">^</mo></mover><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub><mi>v</mi><mi>j</mi></msub><mo>,</mo><msub><mi>v</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><mo>⁢</mo><mstyle displaystyle="true"><mfrac><mo>∂</mo><mrow><mo>∂</mo><mo>⁡</mo><msub><mi>r</mi><mi>j</mi></msub></mrow></mfrac></mstyle><mo>⁢</mo><mover accent="true"><msub><mi>v</mi><mi>i</mi></msub><mo stretchy="false">^</mo></mover></mrow></mrow></mrow><mo>,</mo></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7.13)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">since this will guarantee, that equation (<a href="#E12" title="(7.12) ‣ 7.3 Energy conservation ‣ Chapter 7 Numerical testing ‣ Adaptively Refined Large-Eddy Simulations of Galaxy Clusters" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.12</span></a>) is fullfilled
globally. We found that the global energy is thus much better conserved.</p>
</div>
<div id="S3.p3" class="ltx_para">
<p class="ltx_p">In the following we present our results on energy conservation. The analyzed
simulation of driven turbulence has a static grid of size 1.0 (in code units)
with a resolution of <math id="S3.p3.m1" class="ltx_Math" alttext="256^{3}" display="inline"><msup><mn>256</mn><mn>3</mn></msup></math> grid points and periodic boundary conditions. At
time <math id="S3.p3.m2" class="ltx_Math" alttext="t=0" display="inline"><mrow><mi>t</mi><mo>=</mo><mn>0</mn></mrow></math> the baryonic fluid is at rest. The fluid is driven by random forcing
as described in section <a href="#S2.SS4" title="7.2.4 Random forcing ‣ 7.2 Modifications to Enzo ‣ Chapter 7 Numerical testing ‣ Adaptively Refined Large-Eddy Simulations of Galaxy Clusters" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.2.4</span></a> with <math id="S3.p3.m3" class="ltx_Math" alttext="\zeta=1.0" display="inline"><mrow><mi>ζ</mi><mo>=</mo><mn>1.0</mn></mrow></math> and <math id="S3.p3.m4" class="ltx_Math" alttext="M_{f}=0.68" display="inline"><mrow><msub><mi>M</mi><mi>f</mi></msub><mo>=</mo><mn>0.68</mn></mrow></math>. The
simulation is adiabatic (the adiabatic index <math id="S3.p3.m5" class="ltx_Math" alttext="\gamma=\frac{5}{3}" display="inline"><mrow><mi>γ</mi><mo>=</mo><mfrac><mn>5</mn><mn>3</mn></mfrac></mrow></math>) and uses none
of the features
necessary for a cosmological simulation (comoving coordinates, selfgravity, dark
matter …) except dual energy formalism. The mean sound speed of the
simulation is <math id="S3.p3.m6" class="ltx_Math" alttext="c_{s}=\sqrt{\gamma}" display="inline"><mrow><msub><mi>c</mi><mi>s</mi></msub><mo>=</mo><msqrt><mi>γ</mi></msqrt></mrow></math>, since the mean pressure and density are set
to one in code units.</p>
</div>
<figure id="F2" class="ltx_figure">
<table style="width:100%;">
<tr>
<td class="ltx_subfigure">
<figure id="F1.sf1" class="ltx_figure ltx_align_center"><img src="x11.png" id="F1.sf1.g1" class="ltx_graphics" width="304" height="213" alt="">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>No SGS model.</figcaption>
</figure>
</td>
<td class="ltx_subfigure">
<figure id="F1.sf2" class="ltx_figure ltx_align_center"><img src="x12.png" id="F1.sf2.g1" class="ltx_graphics" width="304" height="213" alt="">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>Schmidt model.</figcaption>
</figure>
</td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7.2: </span>Mass weighted mean energies over time in driven turbulence simulation.</figcaption>
</figure>
<div id="S3.p4" class="ltx_para">
<p class="ltx_p">The plots <a href="#F1.sf1" title="(a) ‣ Figure 7.2 ‣ 7.3 Energy conservation ‣ Chapter 7 Numerical testing ‣ Adaptively Refined Large-Eddy Simulations of Galaxy Clusters" class="ltx_ref"><span class="ltx_text ltx_ref_tag">a</span></a> and <a href="#F1.sf2" title="(b) ‣ Figure 7.2 ‣ 7.3 Energy conservation ‣ Chapter 7 Numerical testing ‣ Adaptively Refined Large-Eddy Simulations of Galaxy Clusters" class="ltx_ref"><span class="ltx_text ltx_ref_tag">b</span></a> show the typical time development of
the mass weighted mean energies in our simulation including the energy injected
into the system by random forcing. It is evident from the curve of the turbulent
energy, that after one integral time scale, our simulation reaches a equilibrium
between production and dissipation of turbulent energy.</p>
</div>
<figure id="F3" class="ltx_figure"><img src="x13.png" id="F3.g1" class="ltx_graphics ltx_centering" width="474" height="332" alt="">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7.3: </span>Relative error of total energy in the simulation.</figcaption>
</figure>
<div id="S3.p5" class="ltx_para">
<p class="ltx_p">In figure <a href="#F3" title="Figure 7.3 ‣ 7.3 Energy conservation ‣ Chapter 7 Numerical testing ‣ Adaptively Refined Large-Eddy Simulations of Galaxy Clusters" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.3</span></a> we plotted the time development of the relative
error <math id="S3.p5.m1" class="ltx_Math" alttext="\frac{\Delta e(t)}{e(0)}" display="inline"><mfrac><mrow><mi mathvariant="normal">Δ</mi><mo>⁢</mo><mi>e</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></mrow><mrow><mi>e</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></mrow></mfrac></math> of the mean total energy,
which is the sum of the mass weighted means of internal energy, kinetic energy,
turbulent energy minus the injected energy due to the forcing</p>
<table id="Ax2.S3.EGx102" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="E14"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="E14.m1" class="ltx_Math" alttext="\displaystyle\hat{e}_{tot}=\hat{e}_{int}+\hat{e}_{kin}+\hat{e}_{t}-\hat{e}_{f}," display="inline"><mrow><mrow><msub><mover accent="true"><mi>e</mi><mo stretchy="false">^</mo></mover><mrow><mi>t</mi><mo>⁢</mo><mi>o</mi><mo>⁢</mo><mi>t</mi></mrow></msub><mo>=</mo><mrow><mrow><msub><mover accent="true"><mi>e</mi><mo stretchy="false">^</mo></mover><mrow><mi>i</mi><mo>⁢</mo><mi>n</mi><mo>⁢</mo><mi>t</mi></mrow></msub><mo>+</mo><msub><mover accent="true"><mi>e</mi><mo stretchy="false">^</mo></mover><mrow><mi>k</mi><mo>⁢</mo><mi>i</mi><mo>⁢</mo><mi>n</mi></mrow></msub><mo>+</mo><msub><mover accent="true"><mi>e</mi><mo stretchy="false">^</mo></mover><mi>t</mi></msub></mrow><mo>-</mo><msub><mover accent="true"><mi>e</mi><mo stretchy="false">^</mo></mover><mi>f</mi></msub></mrow></mrow><mo>,</mo></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7.14)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">where <math id="S3.p5.m2" class="ltx_Math" alttext="\hat{e}=\frac{\langle\rho e\rangle}{\langle\rho\rangle}" display="inline"><mrow><mover accent="true"><mi>e</mi><mo stretchy="false">^</mo></mover><mo>=</mo><mfrac><mrow><mo stretchy="false">⟨</mo><mrow><mi>ρ</mi><mo>⁢</mo><mi>e</mi></mrow><mo stretchy="false">⟩</mo></mrow><mrow><mo stretchy="false">⟨</mo><mi>ρ</mi><mo stretchy="false">⟩</mo></mrow></mfrac></mrow></math>. It demonstrates, that with
our Schmidt model, the relative error in energy is comparable to the error
without SGS model and is around 1%. Also the energy conserving properties of
the Sarkar model are equally good.</p>
</div>
<figure id="F4" class="ltx_figure"><img src="x14.png" id="F4.g1" class="ltx_graphics ltx_centering" width="474" height="332" alt="">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7.4: </span>Differences in energies between simulation with and without SGS model,
compared to the time development of the turbulent energy.</figcaption>
</figure>
<div id="S3.p6" class="ltx_para">
<p class="ltx_p">It is also instructive to plot the difference between internal energy of the
simulation without the SGS model and the internal energy with the Schmidt model
and the
difference between the kinetic energies of both simulations. These differences
are shown in figure <a href="#F4" title="Figure 7.4 ‣ 7.3 Energy conservation ‣ Chapter 7 Numerical testing ‣ Adaptively Refined Large-Eddy Simulations of Galaxy Clusters" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.4</span></a>. One can conclude from this figure,
that, at the beginning of the turbulent driving, the turbulent energy produced
in our simulation with SGS is found in the kinetic energy of the
simulation without SGS. From <math id="S3.p6.m1" class="ltx_Math" alttext="t=1.2\ t_{int}" display="inline"><mrow><mi>t</mi><mo>=</mo><mrow><mpadded width="+5pt"><mn>1.2</mn></mpadded><mo>⁢</mo><msub><mi>t</mi><mrow><mi>i</mi><mo>⁢</mo><mi>n</mi><mo>⁢</mo><mi>t</mi></mrow></msub></mrow></mrow></math> on most of the turbulent energy
can be found in the internal energy of the simulation without SGS.
Turbulent energy can therefore be interpreted as a kind of buffer, which
prevents the kinetic energy in our simulation to be converted instantly into
thermal energy.</p>
</div>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7.4 </span>Scaling of turbulent energy</h2>

<div id="S4.p1" class="ltx_para">
<p class="ltx_p">In our <math id="S4.p1.m1" class="ltx_Math" alttext="\epsilon" display="inline"><mi>ϵ</mi></math>-based approach to combine AMR and LES we assumed that the
turbulent energy scales according to equation <math id="S4.p1.m2" class="ltx_Math" alttext="\eqref{eq:qscale}" display="inline"><mrow><mi>(</mi><mo>⁢</mo><mtext mathvariant="italic"><a href="Ch6.html#E8" title="(6.8) ‣ 6.3 ϵ -based approach to combine AMR and LES ‣ Chapter 6 AMR and LES ‣ Adaptively Refined Large-Eddy Simulations of Galaxy Clusters" class="ltx_ref ltx_font_italic"><span class="ltx_text ltx_ref_tag">6.8</span></a></mtext><mo>⁢</mo><mi>)</mi></mrow></math> like
<math id="S4.p1.m3" class="ltx_Math" alttext="q^{2}\sim l^{2/3}" display="inline"><mrow><msup><mi>q</mi><mn>2</mn></msup><mo>∼</mo><msup><mi>l</mi><mrow><mn>2</mn><mo>/</mo><mn>3</mn></mrow></msup></mrow></math>. We conducted several simulations of driven turbulence to
check the validity of this assumption.</p>
</div>
<div id="S4.p2" class="ltx_para">
<p class="ltx_p">The simulations were done on a static grid in a computational domain of size
1.0 with periodic boundary conditions. At
time <math id="S4.p2.m1" class="ltx_Math" alttext="t=0" display="inline"><mrow><mi>t</mi><mo>=</mo><mn>0</mn></mrow></math> the baryonic fluid is at rest. The fluid is driven by random forcing
as described in section <a href="#S2.SS4" title="7.2.4 Random forcing ‣ 7.2 Modifications to Enzo ‣ Chapter 7 Numerical testing ‣ Adaptively Refined Large-Eddy Simulations of Galaxy Clusters" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.2.4</span></a> with <math id="S4.p2.m2" class="ltx_Math" alttext="\zeta=0" display="inline"><mrow><mi>ζ</mi><mo>=</mo><mn>0</mn></mrow></math> (purely solenoidal
forcing). The simulations were done for nearly isothermal gas
(<math id="S4.p2.m3" class="ltx_Math" alttext="\gamma=1.01" display="inline"><mrow><mi>γ</mi><mo>=</mo><mn>1.01</mn></mrow></math>) with mean pressure and density set to <math id="S4.p2.m4" class="ltx_Math" alttext="1.0" display="inline"><mn>1.0</mn></math> in code units.
We used forcing Mach numbers of <math id="S4.p2.m5" class="ltx_Math" alttext="M_{f}=0.2" display="inline"><mrow><msub><mi>M</mi><mi>f</mi></msub><mo>=</mo><mn>0.2</mn></mrow></math> and <math id="S4.p2.m6" class="ltx_Math" alttext="M_{f}=0.68" display="inline"><mrow><msub><mi>M</mi><mi>f</mi></msub><mo>=</mo><mn>0.68</mn></mrow></math> and varied the
resolution from <math id="S4.p2.m7" class="ltx_Math" alttext="32^{3}" display="inline"><msup><mn>32</mn><mn>3</mn></msup></math> to <math id="S4.p2.m8" class="ltx_Math" alttext="256^{3}" display="inline"><msup><mn>256</mn><mn>3</mn></msup></math> grid points. For <math id="S4.p2.m9" class="ltx_Math" alttext="M_{f}=0.68" display="inline"><mrow><msub><mi>M</mi><mi>f</mi></msub><mo>=</mo><mn>0.68</mn></mrow></math> the simulations
were transonic reaching reaching a Mach number around one (see figure
<a href="#F5" title="Figure 7.5 ‣ 7.4 Scaling of turbulent energy ‣ Chapter 7 Numerical testing ‣ Adaptively Refined Large-Eddy Simulations of Galaxy Clusters" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.5</span></a>).</p>
</div>
<figure id="F5" class="ltx_figure"><img src="x15.png" id="F5.g1" class="ltx_graphics ltx_centering" width="474" height="332" alt="">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7.5: </span>Mean Mach number for adiabatic and isothermal simulation using an
equal
forcing Mach number <math id="F5.m2" class="ltx_Math" alttext="M_{f}=0.68" display="inline"><mrow><msub><mi>M</mi><mi>f</mi></msub><mo>=</mo><mn>0.68</mn></mrow></math>.</figcaption>
</figure>
<div id="S4.p3" class="ltx_para">
<p class="ltx_p">The characteristic time development of the turbulent energy dependent on the
resolution of the simulation can be seen in figures <a href="#F5.sf1" title="(a) ‣ Figure 7.6 ‣ 7.4 Scaling of turbulent energy ‣ Chapter 7 Numerical testing ‣ Adaptively Refined Large-Eddy Simulations of Galaxy Clusters" class="ltx_ref"><span class="ltx_text ltx_ref_tag">a</span></a> -
<a href="#F5.sf4" title="(d) ‣ Figure 7.6 ‣ 7.4 Scaling of turbulent energy ‣ Chapter 7 Numerical testing ‣ Adaptively Refined Large-Eddy Simulations of Galaxy Clusters" class="ltx_ref"><span class="ltx_text ltx_ref_tag">d</span></a>.</p>
</div>
<figure id="F6" class="ltx_figure">
<table style="width:100%;">
<tr>
<td class="ltx_subfigure">
<figure id="F5.sf1" class="ltx_figure ltx_align_center"><img src="x16.png" id="F5.sf1.g1" class="ltx_graphics" width="303" height="229" alt="">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>Schmidt model, <math id="F5.sf1.m2" class="ltx_Math" alttext="M_{f}=0.2" display="inline"><mrow><msub><mi>M</mi><mi>f</mi></msub><mo>=</mo><mn>0.2</mn></mrow></math>.</figcaption>
</figure>
</td>
<td class="ltx_subfigure">
<figure id="F5.sf2" class="ltx_figure ltx_align_center"><img src="x17.png" id="F5.sf2.g1" class="ltx_graphics" width="303" height="229" alt="">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>Sarkar model, <math id="F5.sf2.m2" class="ltx_Math" alttext="M_{f}=0.2" display="inline"><mrow><msub><mi>M</mi><mi>f</mi></msub><mo>=</mo><mn>0.2</mn></mrow></math>.</figcaption>
</figure>
</td>
<td class="ltx_subfigure">
<figure id="F5.sf3" class="ltx_figure ltx_align_center"><img src="x18.png" id="F5.sf3.g1" class="ltx_graphics" width="303" height="229" alt="">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span>Schmidt model., <math id="F5.sf3.m2" class="ltx_Math" alttext="M_{f}=0.7" display="inline"><mrow><msub><mi>M</mi><mi>f</mi></msub><mo>=</mo><mn>0.7</mn></mrow></math></figcaption>
</figure>
</td>
<td class="ltx_subfigure">
<figure id="F5.sf4" class="ltx_figure ltx_align_center"><img src="x19.png" id="F5.sf4.g1" class="ltx_graphics" width="303" height="229" alt="">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(d) </span>Sarkar model, <math id="F5.sf4.m2" class="ltx_Math" alttext="M_{f}=0.7" display="inline"><mrow><msub><mi>M</mi><mi>f</mi></msub><mo>=</mo><mn>0.7</mn></mrow></math>.</figcaption>
</figure>
</td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7.6: </span>Mass weighted mean turbulent energies over time in driven turbulence
simulation, for resolutions <math id="F6.m5" class="ltx_Math" alttext="32^{3}" display="inline"><msup><mn>32</mn><mn>3</mn></msup></math> to <math id="F6.m6" class="ltx_Math" alttext="256^{3}" display="inline"><msup><mn>256</mn><mn>3</mn></msup></math> with forcing Mach number <math id="F6.m7" class="ltx_Math" alttext="M_{f}=0.2" display="inline"><mrow><msub><mi>M</mi><mi>f</mi></msub><mo>=</mo><mn>0.2</mn></mrow></math>
and <math id="F6.m8" class="ltx_Math" alttext="M_{f}=0.68" display="inline"><mrow><msub><mi>M</mi><mi>f</mi></msub><mo>=</mo><mn>0.68</mn></mrow></math>.</figcaption>
</figure>
<div id="S4.p4" class="ltx_para">
<p class="ltx_p">We compute mean turbulent energies by
averaging the turbulent energy from <math id="S4.p4.m1" class="ltx_Math" alttext="t=3.0\ t_{int}" display="inline"><mrow><mi>t</mi><mo>=</mo><mrow><mpadded width="+5pt"><mn>3.0</mn></mpadded><mo>⁢</mo><msub><mi>t</mi><mrow><mi>i</mi><mo>⁢</mo><mi>n</mi><mo>⁢</mo><mi>t</mi></mrow></msub></mrow></mrow></math> to the end of the
simulation
and plot them against the resolution of the simulation. The results together
with a power-law fit are shown in figures <a href="#F6.sf1" title="(a) ‣ Figure 7.7 ‣ 7.4 Scaling of turbulent energy ‣ Chapter 7 Numerical testing ‣ Adaptively Refined Large-Eddy Simulations of Galaxy Clusters" class="ltx_ref"><span class="ltx_text ltx_ref_tag">a</span></a> and
<a href="#F6.sf2" title="(b) ‣ Figure 7.7 ‣ 7.4 Scaling of turbulent energy ‣ Chapter 7 Numerical testing ‣ Adaptively Refined Large-Eddy Simulations of Galaxy Clusters" class="ltx_ref"><span class="ltx_text ltx_ref_tag">b</span></a>.
From this we see that for a low Mach number forcing our assumption
<math id="S4.p4.m2" class="ltx_Math" alttext="q^{2}\sim l^{2/3}" display="inline"><mrow><msup><mi>q</mi><mn>2</mn></msup><mo>∼</mo><msup><mi>l</mi><mrow><mn>2</mn><mo>/</mo><mn>3</mn></mrow></msup></mrow></math> (<math id="S4.p4.m3" class="ltx_Math" alttext="l" display="inline"><mi>l</mi></math> is indirect proportional to the resolution) is fulfilled
indeed. Nevertheless for high Mach number flows the scaling of turbulent energy
becomes steeper and is <math id="S4.p4.m4" class="ltx_Math" alttext="q^{2}\sim l^{0.77}" display="inline"><mrow><msup><mi>q</mi><mn>2</mn></msup><mo>∼</mo><msup><mi>l</mi><mn>0.77</mn></msup></mrow></math> for the Schmidt model and
<math id="S4.p4.m5" class="ltx_Math" alttext="q^{2}\sim l^{0.71}" display="inline"><mrow><msup><mi>q</mi><mn>2</mn></msup><mo>∼</mo><msup><mi>l</mi><mn>0.71</mn></msup></mrow></math> for the Sarkar model. In other words for
higher Mach number flows, our correction of turbulent energy at grid
refinement/derefinement based on relation <math id="S4.p4.m6" class="ltx_Math" alttext="\eqref{eq:qscale}" display="inline"><mrow><mi>(</mi><mo>⁢</mo><mtext mathvariant="italic"><a href="Ch6.html#E8" title="(6.8) ‣ 6.3 ϵ -based approach to combine AMR and LES ‣ Chapter 6 AMR and LES ‣ Adaptively Refined Large-Eddy Simulations of Galaxy Clusters" class="ltx_ref ltx_font_italic"><span class="ltx_text ltx_ref_tag">6.8</span></a></mtext><mo>⁢</mo><mi>)</mi></mrow></math> should probably
be seen only as a good guess of the initial values of turbulent energy on
the finer/coarser grid. Also we conclude that for higher Mach number flows one
should use the Sarkar corrections to the Schmidt model, since this leads
to a scaling of turbulent energy more similar to the incompressible low Mach
number case.</p>
</div>
<figure id="F7" class="ltx_figure">
<table style="width:100%;">
<tr>
<td class="ltx_subfigure">
<figure id="F6.sf1" class="ltx_figure ltx_align_center"><img src="x20.png" id="F6.sf1.g1" class="ltx_graphics" width="303" height="229" alt="">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span><math id="F6.sf1.m2" class="ltx_Math" alttext="M_{f}=0.2" display="inline"><mrow><msub><mi>M</mi><mi>f</mi></msub><mo>=</mo><mn>0.2</mn></mrow></math>.</figcaption>
</figure>
</td>
<td class="ltx_subfigure">
<figure id="F6.sf2" class="ltx_figure ltx_align_center"><img src="x21.png" id="F6.sf2.g1" class="ltx_graphics" width="303" height="229" alt="">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span><math id="F6.sf2.m2" class="ltx_Math" alttext="M_{f}=0.68" display="inline"><mrow><msub><mi>M</mi><mi>f</mi></msub><mo>=</mo><mn>0.68</mn></mrow></math>.</figcaption>
</figure>
</td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7.7: </span>Scaling of turbulent energy dependent on resolution for different
strength of the forcing.</figcaption>
</figure>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7.5 </span>Comparison of static grid to AMR turbulence simulations</h2>

<figure id="F8" class="ltx_figure"><img src="x22.png" id="F8.g1" class="ltx_graphics ltx_centering" width="474" height="332" alt="">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7.8: </span>Thick lines: mean mass weighted turbulent energy for each level of the
AMR simulation using our procedure of transferring turbulent energy at grid
refinement/derefinement. Thin lines: the corresponding development of turbulent
energy of the static grid simulations.</figcaption>
</figure>
<figure id="F9" class="ltx_figure"><img src="x23.png" id="F9.g1" class="ltx_graphics ltx_centering" width="474" height="332" alt="">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7.9: </span>Thick lines: mean mass weighted turbulent energy for each level of the
AMR simulation without transferring turbulent energy at grid
refinement/derefinement. Thin lines: the corresponding development of turbulent
energy of the static grid simulations.</figcaption>
</figure>
<div id="S5.p1" class="ltx_para">
<p class="ltx_p">To be consistent the results of an AMR simulation in the limit of
complete refinement of the whole computational domain should resemble the
results of a corresponding static grid simulation. To test this, we compared
an AMR simulation with a <math id="S5.p1.m1" class="ltx_Math" alttext="32^{3}" display="inline"><msup><mn>32</mn><mn>3</mn></msup></math> root grid resolution and three additional
levels with a refinement factor of 2 between each level, covering the whole
domain, with the corresponding static grid simulations of driven turbulence with
resolutions of <math id="S5.p1.m2" class="ltx_Math" alttext="32^{3},64^{3},128^{3}" display="inline"><mrow><msup><mn>32</mn><mn>3</mn></msup><mo>,</mo><msup><mn>64</mn><mn>3</mn></msup><mo>,</mo><msup><mn>128</mn><mn>3</mn></msup></mrow></math> and <math id="S5.p1.m3" class="ltx_Math" alttext="256^{3}" display="inline"><msup><mn>256</mn><mn>3</mn></msup></math>.</p>
</div>
<div id="S5.p2" class="ltx_para">
<p class="ltx_p">Again the simulations were done in a computational domain of size 1.0 with
periodic boundary conditions. At time <math id="S5.p2.m1" class="ltx_Math" alttext="t=0" display="inline"><mrow><mi>t</mi><mo>=</mo><mn>0</mn></mrow></math> the baryonic fluid is at rest. The
fluid is driven by random forcing as described in section <a href="#S2.SS4" title="7.2.4 Random forcing ‣ 7.2 Modifications to Enzo ‣ Chapter 7 Numerical testing ‣ Adaptively Refined Large-Eddy Simulations of Galaxy Clusters" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.2.4</span></a> with
<math id="S5.p2.m2" class="ltx_Math" alttext="\zeta=0" display="inline"><mrow><mi>ζ</mi><mo>=</mo><mn>0</mn></mrow></math> (purely solenoidal
forcing). The simulations were done for nearly isothermal gas
(<math id="S5.p2.m3" class="ltx_Math" alttext="\gamma=1.01" display="inline"><mrow><mi>γ</mi><mo>=</mo><mn>1.01</mn></mrow></math>) with mean pressure and density set to <math id="S5.p2.m4" class="ltx_Math" alttext="1.0" display="inline"><mn>1.0</mn></math> in code units.
We used a forcing Mach number of <math id="S5.p2.m5" class="ltx_Math" alttext="M_{f}=2.7" display="inline"><mrow><msub><mi>M</mi><mi>f</mi></msub><mo>=</mo><mn>2.7</mn></mrow></math> and therefore used the SGS model
with Sarkar corrections.</p>
</div>
<div id="S5.p3" class="ltx_para">
<p class="ltx_p">The results of this consistency check can be seen in figure <a href="#F8" title="Figure 7.8 ‣ 7.5 Comparison of static grid to AMR turbulence simulations ‣ Chapter 7 Numerical testing ‣ Adaptively Refined Large-Eddy Simulations of Galaxy Clusters" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.8</span></a>.
We observe that the time development of the mean turbulent energy in this
simulation of supersonic driven turbulence simulation is very similar on the
different levels of the AMR simulation compared with the static grid
simulations, except for some deviations at the root level. But comparing these
results to a simulation without correcting turbulent energy at grid
refinement/derefinement (figure <a href="#F9" title="Figure 7.9 ‣ 7.5 Comparison of static grid to AMR turbulence simulations ‣ Chapter 7 Numerical testing ‣ Adaptively Refined Large-Eddy Simulations of Galaxy Clusters" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.9</span></a>), it is evident that our
<math id="S5.p3.m1" class="ltx_Math" alttext="\epsilon" display="inline"><mi>ϵ</mi></math>-based approach of turbulent energy transfer is much more consistent
with the static simulations of driven turbulence.</p>
</div>
</section>
</section>
</div>
<footer class="ltx_page_footer">
<div>
<a href="Ch6.html" title="Chapter 6 AMR and LES ‣ Adaptively Refined Large-Eddy Simulations of Galaxy Clusters" class="ltx_ref" rel="prev"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>AMR and LES</span></a><a href="bib.html" title="References ‣ Adaptively Refined Large-Eddy Simulations of Galaxy Clusters" class="ltx_ref" rel="bibliography"><span class="ltx_text ltx_ref_title">References</span></a><a href="Ch8.html" title="Chapter 8 Cluster physics ‣ Adaptively Refined Large-Eddy Simulations of Galaxy Clusters" class="ltx_ref" rel="next"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">8 </span>Cluster physics</span></a>
</div>
<div class="ltx_page_logo">Generated  on Fri Feb 16 23:21:58 2018 by <a href="http://dlmf.nist.gov/LaTeXML/">LaTeXML <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="[LOGO]"></a>
</div></footer>
</div>
</body>
</html>
